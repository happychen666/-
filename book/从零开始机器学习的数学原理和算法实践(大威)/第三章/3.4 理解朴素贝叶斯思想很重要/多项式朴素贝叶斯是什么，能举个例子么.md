多项式朴素贝叶斯（Multinomial Naive Bayes）是朴素贝叶斯分类器的一种变体，主要用于处理离散型数据，尤其适合文本分类任务。它假设特征（即词或单词的频率）是多项式分布的，即一个样本的特征（例如词汇）是从一个多项式分布中独立选择的。

### 工作原理

多项式朴素贝叶斯的基本原理仍然是贝叶斯定理，通过先验概率、似然函数和证据来计算后验概率。其特点在于：

1. **先验概率**：表示每个类别的概率。
2. **条件概率（似然函数）**：表示在给定类别的情况下，某个特征（如词汇）出现的概率。
3. **后验概率**：基于输入的特征，计算属于某个类别的概率。

模型核心是通过观察样本的特征分布（如词频）来估计类别的可能性。

### 例子

假设我们要用多项式朴素贝叶斯进行垃圾邮件（Spam）和正常邮件（Ham）的分类。我们有一个简单的训练数据集：

| 邮件 | 内容                         | 标签  |
|------|------------------------------|-------|
| 邮件1 | "便宜 促销 现在"               | Spam  |
| 邮件2 | "现在 促销"                   | Spam  |
| 邮件3 | "便宜 促销 马上 购买"          | Spam  |
| 邮件4 | "新产品 发布 购买 机会"        | Ham   |
| 邮件5 | "优惠 新产品 现在 机会"        | Ham   |
| 邮件6 | "产品 发布 促销"              | Ham   |

我们要预测新邮件的类别。假设有一封新邮件 `“促销 购买 现在”`，我们想判断它是 Spam 还是 Ham。

#### 1. 计算先验概率

- \( P(Spam) = \frac{3}{6} = 0.5 \)
- \( P(Ham) = \frac{3}{6} = 0.5 \)

#### 2. 计算条件概率（基于词频）

假设每个类别中的词汇数如下（为方便，加入拉普拉斯平滑）：

- **Spam** 类别下的词汇总数：8（便宜:2, 促销:3, 现在:2, 马上:1, 购买:1）
- **Ham** 类别下的词汇总数：9（新产品:3, 发布:2, 促销:1, 购买:1, 现在:1, 机会:2）

计算每个词在类别中的概率：

- **Spam**:
  - \( P(促销 | Spam) = \frac{3 + 1}{8 + 6} = 0.2857 \)
  - \( P(购买 | Spam) = \frac{1 + 1}{8 + 6} = 0.1429 \)
  - \( P(现在 | Spam) = \frac{2 + 1}{8 + 6} = 0.2143 \)

- **Ham**:
  - \( P(促销 | Ham) = \frac{1 + 1}{9 + 6} = 0.1333 \)
  - \( P(购买 | Ham) = \frac{1 + 1}{9 + 6} = 0.1333 \)
  - \( P(现在 | Ham) = \frac{1 + 1}{9 + 6} = 0.1333 \)

#### 3. 计算后验概率

- **Spam**:
  \[
  P(Spam | 促销, 购买, 现在) = P(Spam) \times P(促销 | Spam) \times P(购买 | Spam) \times P(现在 | Spam)
  \]
  \[
  = 0.5 \times 0.2857 \times 0.1429 \times 0.2143 = 0.0044
  \]

- **Ham**:
  \[
  P(Ham | 促销, 购买, 现在) = P(Ham) \times P(促销 | Ham) \times P(购买 | Ham) \times P(现在 | Ham)
  \]
  \[
  = 0.5 \times 0.1333 \times 0.1333 \times 0.1333 = 0.0012
  \]

#### 4. 比较后验概率

因为 \( P(Spam | 促销, 购买, 现在) > P(Ham | 促销, 购买, 现在) \)，所以我们会预测这封邮件是 Spam。

### 适用场景

- 文本分类：如垃圾邮件检测、情感分析。
- 文档分类：如新闻分类等。

总结来说，多项式朴素贝叶斯特别适合文本分类任务，通过统计每个词在不同类别中的频率，预测新文档的类别。
